apply plugin: 'java'
apply plugin: 'idea'

project.version = "1.0-SNAPSHOT"
project.group = 'com.codingchili'

subprojects {
    apply plugin: 'java'
    apply plugin: 'idea'

    version = rootProject.version
    group = rootProject.version

    sourceCompatibility = 1.8
    targetCompatibility = 1.8

    tasks.withType(JavaCompile) {
        options.encoding = 'UTF-8'
    }

    sourceSets {
        main {
            java {
                srcDir 'main/java'
            }
            resources {
                srcDir 'main/resources'
            }
        }
        test {
            java {
                srcDir 'test/java'
            }
            resources {
                srcDir 'test/resources'
            }
        }
    }

    repositories {
        maven { url 'http://repo.maven.apache.org/maven2' }
    }

    test {
        testLogging {
            exceptionFormat "full"
        }
    }
}

task archiveZip(type: Zip, dependsOn: 'jar') {
    baseName = 'prototype'
    from fileTree('prototype')

    from (subprojects.collect {it.tasks.withType(Jar)}) {
        into 'lib'
    }
}

task copyTask(type: Copy, dependsOn: 'build') {
    from (subprojects.collect {it.tasks.withType(Jar)}) {
        into 'release'
    }
    from (subprojects.collect {it.tasks.withType(Javadoc)}) {
        into 'release'
    }
    from (subprojects.collect {it.tasks.withType(AbstractArchiveTask)}) {
        into 'release'
    }
}

